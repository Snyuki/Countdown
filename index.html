<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Countdown</title>

  <style>
    /* ========== PAGE STYLING ========== */
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #ffe6ec, #f9d9f2);
      font-family: 'Poppins', sans-serif;
      overflow: hidden;
      color: #444;
    }

    /* ========== COUNTDOWN CONTAINER ========== */
    .countdown-container {
      position: relative;
      z-index: 2;
      text-align: center;
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 2rem 3rem;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
    }

    .title {
      font-size: 1.4rem;
      font-weight: 500;
      margin-bottom: 1rem;
      color: #b85ca8;
    }

    .timer {
      font-size: 2.2rem;
      letter-spacing: 2px;
      color: #d46ba0;
      white-space: nowrap; /* force single line */
    }

    /* Responsive: shrink text if too long */
    @media (max-width: 500px) {
      .timer { font-size: 1.8rem; }
    }
    @media (max-width: 400px) {
      .timer { font-size: 1.5rem; }
    }

    /* ========== 3D HEART CANVAS ========== */
    #heart-canvas {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 400px;
      height: 400px;
      transform: translate(-50%, -50%);
      z-index: 1;
    }
  </style>
</head>
<body>

  <!-- 3D HEART BACKGROUND -->
  <canvas id="heart-canvas"></canvas>

  <!-- COUNTDOWN UI -->
  <div class="countdown-container">
    <!--<div class="title">Countdown to December 22, 12:30</div>-->
    <div id="timer" class="timer">Loading...</div>
  </div>

  <!-- Load Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

  <script>
    /* ========== COUNTDOWN LOGIC ========== */
    const timerEl = document.getElementById("timer");
    const targetDate = new Date("2025-12-22T12:50:00");

    function updateCountdown() {
      const now = new Date();
      const diff = targetDate - now;
      if (diff <= 0) {
        timerEl.textContent = "やっと会える！❤️";
        clearInterval(interval);
        return;
      }
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
      const minutes = Math.floor((diff / (1000 * 60)) % 60);
      const seconds = Math.floor((diff / 1000) % 60);
      timerEl.textContent = `${days}d : ${hours.toString().padStart(2, '0')}h : ${minutes.toString().padStart(2, '0')}m : ${seconds.toString().padStart(2, '0')}s`;
    }
    const interval = setInterval(updateCountdown, 1000);
    updateCountdown();

    /* ========== THREE.JS HEART SETUP ========== */
    const canvas = document.getElementById("heart-canvas");
    const scene = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 1000);
    camera.position.z = 8;

    const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
    renderer.setSize(canvas.clientWidth, canvas.clientHeight);
    renderer.setPixelRatio(window.devicePixelRatio);

    // Soft pink ambient and directional light
    const ambientLight = new THREE.AmbientLight(0xffb6c1, 0.7);
    const directionalLight = new THREE.DirectionalLight(0xffc0cb, 1);
    directionalLight.position.set(5, 5, 5);
    scene.add(ambientLight, directionalLight);

    // Create a smooth 3D heart shape
    const x = 0, y = 0;
    const heartShape = new THREE.Shape();
    heartShape.moveTo(x + 0, y + 2);
    heartShape.bezierCurveTo(x + 2, y + 3.5, x + 4, y + 1.5, x + 0, y - 2);
    heartShape.bezierCurveTo(x - 4, y + 1.5, x - 2, y + 3.5, x + 0, y + 2);

    const extrudeSettings = {
      depth: 1,
      bevelEnabled: true,
      bevelThickness: 0.3,
      bevelSize: 0.3,
      bevelSegments: 8,
      steps: 2,
      curveSegments: 64
    };

    const geometry = new THREE.ExtrudeGeometry(heartShape, extrudeSettings);
    geometry.center();

    const material = new THREE.MeshStandardMaterial({
      color: 0xff7ea8,
      metalness: 0.3,
      roughness: 0.4,
      emissive: 0xffaacc,
      emissiveIntensity: 0.1
    });

    const heart = new THREE.Mesh(geometry, material);
    heart.rotation.x = Math.PI;       // make upright
    heart.rotation.z = Math.PI;       // stand on bottom tip
    scene.add(heart);

    // Animation loop
    function animate() {
      requestAnimationFrame(animate);
      heart.rotation.y += 0.005; // slow spin
      renderer.render(scene, camera);
    }
    animate();

    // Handle resizing
    window.addEventListener("resize", () => {
      const size = Math.min(window.innerWidth, window.innerHeight) * 0.5;
      renderer.setSize(size, size);
      camera.aspect = 1;
      camera.updateProjectionMatrix();
    });
  </script>
</body>
</html>
